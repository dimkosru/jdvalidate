!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JediValidate=t():e.JediValidate=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=4)}([function(e,t,r){"use strict";function n(e){return!!e&&"object"==typeof e}function a(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"!==t&&"[object Date]"!==t}function s(e){return Array.isArray(e)?[]:{}}function i(e,t){return t&&!0===t.clone&&l(e)?c(s(e),e,t):e}function o(e,t,r){var n=e.slice();return t.forEach(function(t,a){void 0===n[a]?n[a]=i(t,r):l(t)?n[a]=c(e[a],t,r):-1===e.indexOf(t)&&n.push(i(t,r))}),n}function u(e,t,r){var n={};return l(e)&&Object.keys(e).forEach(function(t){n[t]=i(e[t],r)}),Object.keys(t).forEach(function(a){l(t[a])&&e[a]?n[a]=c(e[a],t[a],r):n[a]=i(t[a],r)}),n}function c(e,t,r){var n=Array.isArray(t),a=Array.isArray(e),s=r||{arrayMerge:o};if(n===a)return n?(s.arrayMerge||o)(e,t,r):u(e,t,r);return i(t,r)}var l=function(e){return n(e)&&a(e)};c.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,r){return c(e,r,t)})};var f=c;e.exports=f},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=e[0];return 0===r.length?t:"[]"===r?[s(e.slice(1),t)]:a({},r,s(e.slice(1),t))}function i(e,t){return e.reduce(function(e,t){return t&&e?e[t]:e},t||"")}function o(e,t){return i((0,y.convertNameToPath)(e),t)}function u(e){var t=[].concat(n(e)).map(function(e){return c(e)}).filter(Boolean);return t.length>1?t:t[0]}function c(e){if(!e)return"";var t=e.type;if(Array.isArray(e))return u(e);switch(t){case"select-one":return e.options&&e.options[e.selectedIndex]?e.options[e.selectedIndex].value:"";case"select-multiple":return[].concat(n(e.options)).filter(function(e){return e.selected}).map(function(e){return e.value});case"checkbox":case"radio":return e.checked?e.value:"";case"file":return e.files;default:return e.value}}function l(e){return Array.isArray(e)?e[0].name:e.name}function f(e){var t=c(e),r=l(e);return s((0,y.convertNameToPath)(r),t)}function d(e){return Object.keys(e).reduce(function(t,r){return(0,h.default)(t,f(e[r]))},{})}Object.defineProperty(t,"__esModule",{value:!0}),t.createObject=s,t.getValueByPath=i,t.getValueByName=o,t.getRadioGroupValue=u,t.getInputValue=c,t.getInputName=l,t.getInputData=f,t.getData=d;var p=r(0),h=function(e){return e&&e.__esModule?e:{default:e}}(p),y=r(2)},function(e,t,r){"use strict";function n(e,t){return Array.isArray(t)?t.reduce(function(r,a){return r+n(e+"["+a+"]",t[a])},""):"object"===(void 0===t?"undefined":i(t))?Object.keys(t).reduce(function(r,a){return r+n(e+"["+a+"]",t[a])},""):e+"="+encodeURIComponent(t)+"&"}function a(e){for(var t=[],r=o.exec(e);null!==r;)r.index===o.lastIndex&&(o.lastIndex+=1),t.push(r[2]||r[1]),r=o.exec(e);return t}function s(e,t){var r=void 0;switch(t){case"serialize":return r=Object.keys(e).reduce(function(t,r){return""+t+n(r,e[r])},""),r.length?r.slice(0,-1):"";case"formData":return Object.keys(e).reduce(function(t,r){if(e[r]instanceof FileList)if(e[r].length>1)for(var n=0;n<e[r].length;n+=1)t.append(r+"["+n+"]",e[r][n]);else 1===e[r].length&&t.append(r,e[r][0]);else"object"===i(e[r])?Object.keys(e[r]).forEach(function(n){return t.append(r+"["+n+"]",e[r][n])}):t.append(r,e[r]);return t},new FormData);case"json":default:return JSON.stringify(e)}}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getQueryPart=n,t.convertNameToPath=a,t.convertData=s;var o=/(\[(\w*)\]|\w*)/gi},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(5),i=function(){function e(t){n(this,e),this.dictionary={},this.defaultLanguage="en",this.addTranslations(s),this.addTranslations(t)}return a(e,[{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultLanguage;return this.dictionary[t]&&this.dictionary[t][e]||e}},{key:"addTranslation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultLanguage;void 0===this.dictionary[r]&&(this.dictionary[r]={}),this.dictionary[r][e]=t}},{key:"addTranslations",value:function(e){var t=this;Object.keys(e).forEach(function(r){Object.keys(e[r]).forEach(function(n){t.addTranslation(n,e[r][n],r)})})}}]),e}();t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=n(u),l=r(1),f=r(2),d=r(3),p=n(d),h=r(6),y=r(7),v=r(8),g=r(9),m=n(g),b=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,e),this.fields={},this.inputs={},this.messages={},this.errorMessages={},this.data={},this.methods=i({},m.default),this.options={},this.rules={},this.dictionary=null,this.translate=function(e){return r.dictionary.translate(e,r.options.language)};var a={ajax:{url:null,enctype:"application/x-www-form-urlencoded",sendType:"serialize",method:"GET"},rules:{},messages:{},containers:{parent:"form-group",message:"help-block",baseMessage:"base-error"},states:{error:"error",valid:"valid",pristine:"pristine",dirty:"dirty"},formStatePrefix:"jedi-",callbacks:{success:function(e){e.event,e.response},error:function(e){e.errors}},clean:!0,redirect:!0,language:"en",translations:{}};this.root=t,this.options=(0,c.default)(a,n),this.nodes=e.cacheNodes(this.root,this.options);var o=(0,h.getFormOptions)(this.nodes.form);this.options=(0,c.default)(this.options,a),this.options=(0,c.default)(this.options,o),this.options=(0,c.default)(this.options,n),this.rules=i({},this.options.rules),this.dictionary=new p.default(this.options.translations),this.ready(),this.errorMessages=e.initErrorMessages(this.rules,this.options.messages,this.methods,this.options.language)}return o(e,[{key:"ready",value:function(){var t=this;this.nodes.form.setAttribute("novalidate","novalidate"),this.nodes.form.addEventListener("submit",function(r){t.data=(0,l.getData)(t.inputs);var n=(0,y.validateData)(t.rules,t.methods,t.data,t.errorMessages,t.translate);if(n&&0!==Object.keys(n).filter(function(e){return n[e]}).length){Object.keys(n).forEach(function(r){return e.markField(t.fields[r],t.messages[r],t.options.states,n[r])});try{t.options.callbacks.error({errors:n})}catch(e){console.error(e)}return void r.preventDefault()}if(t.options.ajax&&t.options.ajax.url){r.preventDefault();var a=(0,f.convertData)(t.data,t.options.ajax.sendType);t.send(i({},t.options.ajax,{data:a}))}else try{t.options.callbacks.success({event:r})}catch(e){console.error(e)}}),this.nodes.inputs.forEach(function(r){var n=r.name;if(t.inputs[n])if(Array.isArray(t.inputs[n]))t.inputs[n].push(r);else{var a=[t.inputs[n],r];a.name=n,t.inputs[n]=a}else{t.inputs[n]=r;var s=r.parentNode;do{if(s.classList.contains(t.options.containers.parent)){t.fields[n]=s;break}s=s.parentNode}while(s&&s.classList);if(!t.fields[n])return console.warn("Input "+n+" has no parent field"),void delete t.inputs[n];t.fields[n].classList.add(t.options.states.pristine);var o=t.fields[n].querySelector("."+t.options.containers.message);o?t.messages[n]=o:(t.messages[n]=document.createElement("div"),t.messages[n].classList.add(t.options.containers.message),t.fields[n].appendChild(t.messages[n])),t.rules[n]=t.rules[n]||{};var u=(0,h.getInputRules)(r);t.rules[n]=(0,c.default)(u,t.rules[n]),Object.keys(t.rules[n]).forEach(function(e){t.rules[n][e]&&t.fields[n].classList.add(e)})}r.addEventListener("change",function(){t.fields[n].classList.remove(t.options.states.dirty);var a=(0,l.getInputData)(r),s=(0,l.getValueByName)(n,a);t.data=i({},t.data,a);var o=(0,y.validateField)(t.rules[n],t.methods,s,n,t.errorMessages,t.data,t.translate);e.markField(t.fields[n],t.messages[n],t.options.states,o)}),r.addEventListener("input",function(){t.fields[n].classList.remove(t.options.states.pristine),t.fields[n].classList.add(t.options.states.dirty)})})}},{key:"send",value:function(t){var r=this;(0,v.ajax)(t).then(function(t){if(t.validationErrors){try{r.options.callbacks.error({errors:t.validationErrors})}catch(e){console.error(e)}t.validationErrors.base?(r.nodes.baseMessage.innerHTML=t.validationErrors.base.join(", "),r.root.classList.add(r.options.formStatePrefix+r.options.states.error),r.root.classList.remove(r.options.formStatePrefix+r.options.states.valid),delete t.validationErrors.base):r.nodes.baseMessage.innerHTML="",Object.keys(t.validationErrors).forEach(function(n){return e.markField(r.fields[n],r.messages[n],r.options.states,t.validationErrors[n])})}else{try{r.options.callbacks.success({response:t})}catch(e){console.error(e)}if(r.options.redirect&&t.redirect)return void(window.location.href=t.redirect);r.options.clean&&r.nodes.form.reset()}}).catch(function(e){var t=e.method,n=e.url,a=e.status,s=e.statusText;console.warn(t+" "+n+" "+a+" ("+s+")"),r.nodes.baseMessage.innerHTML=r.translate("Can not send form!"),r.root.classList.add(r.options.formStatePrefix+r.options.states.error),r.root.classList.remove(r.options.formStatePrefix+r.options.states.valid)})}},{key:"collect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){if(Array.isArray(t))return t.reduce(function(t,r){var n=(0,l.getInputData)(e.inputs[r]);return e.data=i({},e.data,n),i({},t,n)},{});var r=(0,l.getInputData)(this.inputs[t]);return this.data=i({},this.data,r),r}return this.data=(0,l.getData)(this.inputs),this.data}},{key:"addMethod",value:function(t,r,n){this.methods[t]={func:r,message:n},this.errorMessages=e.initErrorMessages(this.rules,this.options.messages,this.methods,this.options.language)}},{key:"addToDictionary",value:function(e,t,r){this.dictionary.addTranslation(e,t,r)}}],[{key:"cacheNodes",value:function(e,t){return{form:e.querySelector("form"),inputs:e.querySelectorAll("form [name]"),baseMessage:e.querySelector("."+t.containers.baseMessage)}}},{key:"markField",value:function(t,r,n,a){a&&a.length?e.markError(t,r,n,a):e.markValid(t,r,n)}},{key:"markError",value:function(e,t,r,n){var a=r.error,s=r.valid;e&&t&&(e.classList.add(a),e.classList.remove(s),t.innerHTML=n.join(", "))}},{key:"markValid",value:function(e,t,r){var n=r.error,a=r.valid;e&&t&&(e.classList.add(a),e.classList.remove(n),t.innerHTML="")}},{key:"initErrorMessages",value:function(e,t,r){return Object.keys(e).reduce(function(n,s){return i({},n,a({},s,Object.keys(e[s]).reduce(function(e,n){return i({},e,a({},n,t[s]&&t[s][n]||r[n]&&r[n].message||""))},{})))},{})}}]),e}();e.exports=b},function(e,t){e.exports={ru:{"This field is required":"Это поле необходимо заполнить","Please, provide correct value":"Пожалуйста, введите корректное значение","This email is incorrect":"Пожалуйста, введите корректный адрес электронной почты","This file is too large":"Попробуйте загрузить файл поменьше","This extension is not supported":"Пожалуйста, выберите файл с правильным расширением","This phone number is incorrect":"Не корректный номер телефона","Wrong url":"Не корректный url","Can not send form!":"Форма не отправлена!","JSON parsing error":"Ошибка разбора JSON"}}},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){var t=e.getAttribute("enctype");return{ajax:{enctype:t,url:e.getAttribute("action"),method:e.getAttribute("method"),sendType:"multipart/form-data"===t?"formData":void 0}}}function s(e){var t=["required","email","tel","url"],r=t.reduce(function(t,r){return i({},t,n({},r,e.hasAttribute(r)||e.type===r||e.classList.contains(r)))},{});return i({},r,{regexp:e.hasAttribute("pattern")?new RegExp(e.getAttribute("pattern")):void 0})}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.getFormOptions=a,t.getInputRules=s},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return Array.isArray(e)?e:Array.from(e)}function s(e,t){if(!e)return null;var r=!0,n=e;if(Array.isArray(e)){var s=[],i=a(e);if(n=i[0],s=i.slice(1),!n)return null;try{r=s.reduce(function(e,r){return e&&("function"==typeof r?r(t):!!t[r])},r)}catch(e){console.warn("Dependency function error: "+e.toString())}}return r?n:null}function i(e,t,r,n,a,i,o){var u=!t.required.func(r),c=s(e.required,i);return u&&c?[o(a[n].required)]:u?[]:Object.keys(e).reduce(function(u,c){var l=s(e[c],i);if(null===l)return u;if(t[c]){t[c].func(r,l)||u.push(o(a[n][c]))}else u.push('Method "'+c+'" not found');return u},[])}function o(e,t,r,a,s){return Object.keys(e).reduce(function(o,l){var f=(0,c.getValueByName)(l,r),d=i(e[l],t,f,l,a,r,s);return u({},o,n({},l,d.length?d:void 0))},{})}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.isCheckable=s,t.validateField=i,t.validateData=o;var c=r(1)},function(e,t,r){"use strict";function n(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.open(e.method,e.url+("GET"===e.method.toUpperCase()?"?"+e.data:""),!0),"serialize"===e.sendType?n.setRequestHeader("Content-type",e.enctype):"json"===e.sendType&&n.setRequestHeader("Content-type","application/json; charset=utf-8"),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var s={};try{s=JSON.parse(n.responseText)}catch(e){s.validationErrors={base:[(0,a.translate)("JSON parsing error")]}}t(s)}else r({xhr:n,method:e.method,url:e.url,status:n.status,statusText:n.statusText})},n.send("POST"===e.method.toUpperCase()?e.data:"")})}Object.defineProperty(t,"__esModule",{value:!0}),t.ajax=n;var a=r(3);t.default=n},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default={required:{func:function(e){return!!e&&((!Array.isArray(e)||0!==e.length)&&(!(e instanceof FileList&&0===e.length)&&("string"!=typeof e||""!==e.trim())))},message:"This field is required"},regexp:{func:function(e,t){return t.test(e)},message:"Please, provide correct value"},email:{func:function(e){return/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i.test(e)},message:"This email is incorrect"},filesize:{func:function(e,t){return[].concat(n(e)).reduce(function(e,r){return r.size<t&&e},!0)},message:"This file is too large"},extension:{func:function(e,t){return[].concat(n(e)).reduce(function(e,r){return-1!==t.indexOf(r.name.split(".").pop())&&e},!0)},message:"This extension is not supported"},tel:{func:function(e){return/^([+]+)*[0-9\x20\x28\x29-]{5,20}$/.test(e)},message:"This phone number is incorrect"},url:{func:function(e){return/[-a-zA-Z0-9@:%_+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&\/\/=]*)?/gi.test(e)},message:"Wrong url"}}}])});